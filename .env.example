# =============================================================================
# Collabora Standalone - Environment Configuration
# =============================================================================
# Copy this file to .env and customize for your environment
#
# IMPORTANT: Generate secure secrets before deployment!
# Run: ./scripts/generate-secrets.sh
# Or manually generate each secret with: openssl rand -hex 32
#
# WARNING: Never commit the actual .env file with real secrets to version control!

# -----------------------------------------------------------------------------
# Domain Configuration
# -----------------------------------------------------------------------------
DOMAIN=localhost

# -----------------------------------------------------------------------------
# Collabora Admin Console (/browser/dist/admin/admin.html)
# -----------------------------------------------------------------------------
COLLABORA_ADMIN_USER=admin
# Generate with: openssl rand -base64 24
COLLABORA_ADMIN_PASSWORD=CHANGE_ME_GENERATE_SECURE_PASSWORD

# -----------------------------------------------------------------------------
# Security Secrets (REQUIRED - Generate before first run!)
# -----------------------------------------------------------------------------
# Generate each with: openssl rand -hex 32
JWT_SECRET=CHANGE_ME_GENERATE_WITH_openssl_rand_-hex_32
WOPI_SECRET=CHANGE_ME_GENERATE_WITH_openssl_rand_-hex_32

# -----------------------------------------------------------------------------
# PostgreSQL Database
# -----------------------------------------------------------------------------
POSTGRES_USER=collabora
# Generate with: openssl rand -base64 24
POSTGRES_PASSWORD=CHANGE_ME_GENERATE_SECURE_PASSWORD
POSTGRES_DB=collabora_db

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
NODE_ENV=development
LOG_LEVEL=debug
LOG_TO_FILE=false

# Storage limits
MAX_UPLOAD_SIZE=100
STORAGE_QUOTA_PER_USER=5368709120

# Session timeout (seconds)
SESSION_TIMEOUT=86400

# Rate limiting
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=900

# -----------------------------------------------------------------------------
# Authentication Mode
# -----------------------------------------------------------------------------
# Options: local, ldap, ltpa, ldap_ltpa, hybrid
# - local: Database users only (default)
# - ldap: LDAP/Active Directory authentication
# - ltpa: IBM WebSphere LTPA2 SSO
# - ldap_ltpa: Combined LDAP + LTPA (SSO with LDAP validation)
# - hybrid: LDAP with local fallback
AUTH_MODE=local

# -----------------------------------------------------------------------------
# LDAP Configuration (for AUTH_MODE=ldap or hybrid)
# Note: Use quotes for values containing spaces (e.g., "cn=First Last,o=Org")
# Note: Use single quotes for complex filters with & (e.g., '(&(uid={{username}})(objectclass=inetOrgPerson))')
# -----------------------------------------------------------------------------
LDAP_URL="ldap://ldap.example.com:389"
LDAP_BASE_DN="dc=example,dc=com"
LDAP_BIND_DN="cn=service,dc=example,dc=com"
LDAP_BIND_PASSWORD=""
LDAP_USER_SEARCH_BASE="ou=users"
# Simple filter:
LDAP_USER_SEARCH_FILTER='(uid={{username}})'
# Complex filter example (uncomment to use):
# LDAP_USER_SEARCH_FILTER='(&(uid={{username}})(objectclass=inetOrgPerson))'
LDAP_GROUP_SEARCH_BASE=ou=groups
LDAP_GROUP_SEARCH_FILTER=(member={{dn}})
LDAP_USERNAME_ATTR=uid
LDAP_EMAIL_ATTR=mail
LDAP_DISPLAY_NAME_ATTR=cn
LDAP_ADMIN_GROUP=cn=admins
LDAP_TLS_REJECT_UNAUTHORIZED=true
LDAP_TIMEOUT=5000
LDAP_CONNECT_TIMEOUT=10000

# -----------------------------------------------------------------------------
# LTPA2 SSO Configuration (for AUTH_MODE=ltpa or hybrid)
# -----------------------------------------------------------------------------
# Get these values from your WebSphere/Liberty ltpa.keys file
LTPA_SECRET_KEY=
LTPA_PUBLIC_KEY=
LTPA_PRIVATE_KEY=
LTPA_COOKIE_NAME=LtpaToken2
LTPA_REALM=defaultRealm
LTPA_TOKEN_EXPIRATION=7200
LTPA_TRUSTED_DOMAINS=
